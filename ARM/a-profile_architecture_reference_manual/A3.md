# Chapter A3 Armv9 Architecture Extensions

## A3.1 Armv9-A architecture extensions

$\triangle$ An implementation of the Armv9-A architecture must include all of the extensions that this section describes as mandatory. Such an implementation is also called an implementation of the Armv9-A architecture.

$\triangle$ The AArch32 state might optionally be implemented at EL0. The AArch32 state is not implemented at EL1, EL2 and EL3.

$\triangle$ The implementation of FEAT_DoubleLock in an Armv9 implementation is prohibited.

$\triangle$ An implementation of the Armv9-A architecture cannot include an ETM.

$\triangle$ **FEAT_SVE2, Scalable Vector Extension version 2**. The Scalable Vector Extension version 2 (SVE2) is a superset of SVE that incorporates functionality similar to Advanced SIMD, and other enhancements. This feature is supported in AArch64 state only. This feature is OPTIONAL in an Armv9.0 implementation, standard Armv9-A software platforms support FEAT_SVE2. This feature requires FEAT_SVE. The following fields indicate the presence of FEAT_SVE2: ID_AA64PFR0_EL1.SVE; ID_AA64ZFR0_EL1.SVEver.

$\triangle$ **FEAT_SVE_AES, Scalable Vector AES instructions**. FEAT_SVE_AES provides the following SVE AES cryptographic instructions: `AESD`, `AESE`, `AESIMC`, `AESMC. This feature is supported in AArch64 state only. This feature is OPTIONAL in an Armv9.0 implementation. FEAT_SVE_AES requires FEAT_SVE2.

$\triangle$ **FEAT_SVE_BitPerm, Scalable Vector Bit Permutes instructions**. FEAT_SVE_BitPerm provides the following SVE bit permute instructions: `BEXT`, `BDEP`, `BGRP`. This feature is supported in AArch64 state only. This feature is OPTIONAL in an ARM9.0 implementation. FEAT_SVE_BitPerm requires FEAT_SVE2. The ID_AA64ZFR0_EL1.BitPerm field identifies support for FEAT_SVE_BitPerm.

$\triangle$ **FEAT_SVE_PMULL128, Scalable Vector PMULL instructions**. FEAT_SVE_PMULL128 provides the following SVE 128-bit polynomial multiply instructions: `PMULLB`, `PMULLT`. This feature is supported in AArch64 state only. This feature is OPTIONAL in an Armv9.0 implementation. FEAT_SVE_PMULL128 requires FEAT_SVE2. The ID_AA64ZFR0_EL1.AES field identifies support for FEAT_SVE_PMULL128.

$\triangle$ **FEAT_SVE_SHA3, Scalable Vector SHA3 instructions**. FEAT_SVE_SHA3 provides the following SVE SHA3 cryptographic instruction: `RAX1`. This feature is supported in AArch64 state only. This feature is OPTIONAL in an Armv9.0 implementation. FEAT_SVE_SHA3 requires FEAT_SVE2. The ID_AA64ZFR0_EL1.SHA3 field identifies support for FEAT_SVE_SHA3.

$\triangle$ **FEAT_SVE_SM4, Scalable Vector SM4 instructions**. FEAT_SVE_SM4 provides the following SVE SM4 cryptographic instructions: `SM4E`, `SM4EKEY`. This feature is supported in AArch64 state only. This feature is OPTIONAL in an Armv9.0 implementation. FEAT_SVE_SM4 requires FEAT_SVE2. The ID_AA64ZFR0_EL1.SM4 field identifies support for FEAT_SVE_SM4.

$\triangle$ **FEAT_ETE, Embedded Trace Extension**. FEAT_ETE provides a trace unit that records details about software control flow running on a PE, which can be used to aid debugging or optimizing. The trace unit provides filtering functionality to allow the targeting of the information to specific code regions or periods of operation. This feature is supported in AArch64 state, and performs trace in both AArch64 and AArch32 states. This feature is OPTIONAL in an Armv9.0 implementation. This feature requires FEAT_TRBE and FEAT_TRF. The ID_AA64DFR0_EL1.TraceVer field identifies the presence of FEAT_ETE.

$\triangle$ **FEAT_TME, Transactional Memory Extension**. FEAT_TME introduces a set of instructions to support hardware transaction memory, which means a group of instructions can appear to be collectively executed as a single atomic operation. For more information on these instructions, see: `TCANCEL`, `TCOMMIT`, `TSTART`, `TTEST`. This feature is supported in AArch64 state only. This feature is OPTIONAL in an Armv9.0 implementation. The ID_AA64ISAR0_EL1.TME field identifies the presence of FEAT_TME.

$\triangle$ **FEAT_TRBE, Trace Buffer Extension**. FEAT_TRBE enables support for a Trace Buffer Unit within a PE. When the Trace Buffer Unit is enabled, program-flow trace generated by a trace unit is written directly to memory by the Trace Buffer Unit, rather than routing trace data to a trace sink. This feature is supported in AArch64 state, and performs trace in both AArch64 and AArch32 states. This feature is OPTIONAL in an Armv9.0 implementation. FEAT_TRBE requires FEAT_ETE and FEAT_TRF. The ID_AA64DFR0_EL1.TraceBuffer field identifies support for FEAT_TRBE.

$\triangle$ **FEAT_ETEv1p1, Embedded Trace Extension**. FEAT_ETEv1p1 extends FEAT_ETE to support FEAT_FGT. This feature is supported in AArch64 state, and performs trace in both AArch64 and AArch32 states. This feature is OPTIONAL in an Armv9.1 implementation. This feature requires FEAT_ETE. The TRCDEVARCH.REVISION field identifies the presence of FEAT_ETEv1p1.

$\triangle$ **FEAT_BRBE, Branch Record Buffer Extension**. FEAT_BRBE provides a Branch record buffer for capturing control path history. This feature is supported in AArch64 state only. This feature is OPTIONAL in an Armv9.2 implementation. The ID_AA64DFR0_EL1.BRBE field identifies the presence of FEAT_BRBE.

$\triangle$ **FEAT_ETEv1p2, Embedded Trace Extension**. FEAT_ETEv1p2 extends FEAT_ETE to support FEAT_RME. This feature is supported in AArch64 state, and performs trace in both AArch64 and AArch32 states. This feature is OPTIONAL in an Armv9.2 implementation. This feature requires FEAT_ETEv1p1. This feature is required if FEAT_RME is implemented and FEAT_ETE is implemented. The TRCDEVARCH.REVISION field identifies the presence of FEAT_ETEv1p2.

$\triangle$ **FEAT_BRBEv1p1, Branch Record Buffer Extension**. FEAT_BRBEv1p1 enables branch recording at EL3. This feature is supported in AArch64 state only. This feature requires FEAT_BRBE. If FEAT_BRBE is implemented, an Armv9.3-compliant implementation includes the FEAT_BRBEv1p1 feature. The ID_AA64DFR0_EL1.BRBE field identifies the presence of FEAT_BRBEv1p1.

$\triangle$ **FEAT_RME, Realm Management Extension**. FEAT_RME is one component of the Arm Confidential Compute Architecture (Arm CCA). Together with the other components of the Arm CCA, RME enables support for dynamic, attestable, and trusted execution environments (Realms) to be run on an Arm PE. This feature is supported in AArch64 state only. This feature is OPTIONAL in an Armv9.2 implementation. FEAT_RME requires FEAT_RNG or FEAT_RNG_TRAP. If the Trace Architecture is implemented, a PE that implements FEAT_RME also implements FEAT_ETEv1p2.

$\triangle$ **FEAT_SME, Scalable Matrix Extension**. FEAT_SME introduces two AArch64 execution modes that can be enabled and disabled by application software:
- In ZA mode, scalable, two-dimensional, architectural ZA tile storage becomes available and instructions are defined to load, store, extract, insert, and clear rows and columns of the ZA tiles.
- In Streaming SVE mode, the Effective SVE vector length changes to match the Effective ZA tile width, support for a substantial subset of the SVE2 instruction set is available, and, when ZA mode is also enabled, instructions are defined that accumulate the matrix outer product of two SVE vectors into a ZA tile.

This feature is supported in AArch64 state only. This feature is OPTIONAL from Armv9.2. The ID_AA64PFR1_EL1.SME field identifies the presence of FEAT_SME.

$\triangle$ **FEAT_SME_FA64, Full Streaming SVE mode instructions**. FEAT_SME_FA64 supports the full A64 instruction set in Streaming SVE mode. This feature is supported in AArch64 state only. This feature is OPTIONAL in an Armv9.2 implementation. FEAT_SME_FA64 requires FEAT_SME. The ID_AA64SMFR0_EL1.FA64 field identifies support for FEAT_SME_FA64.

$\triangle$ **FEAT_EBF16, AArch64 Extended BFloat16 instructions**. FEAT_EBF16 supports the Extended BFloat16 mode. This feature is supported in AArch64 state only. This feature is OPTIONAL in an Armv9.2 implementation. FEAT_EBF16 requires FEAT_SME. The ID_AA64ISAR1_EL1.BF16 and ID_AA64ZFR0_EL1.BF16 fields identify the presence of FEAT_EBF16, and must return the same value.

$\triangle$ **FEAT_SME_F64F64, Double-precision floating-point outer product instructions**. FEAT_SME_F64F64 indicates SME support for instructions that accumulate into FP64 double-precision floating-point elements in the ZA array. This feature is supported in AArch64 state only. This feature is OPTIONAL in an Armv9.2 implementation. FEAT_SME_F64F64 requires FEAT_SME. The ID_AA64SMFR0_EL1.F64F64 field identifies support for FEAT_SME_F64F64.

$\triangle$ **FEAT_SME_I16I64, 16-bit to 64-bit integer widening outer product instructions**. FEAT_SME_I16I64 indicates SME support for instructions that accumulate into 64-bit integer elements in the ZA array. This feature is supported in AArch64 state only. This feature is OPTIONAL in an Armv9.2 implementation. FEAT_SME_I16I64 requires FEAT_SME. The ID_AA64SMFR0_EL1.I16I64 field identifies support for FEAT_SME_I16I64.

### A3.1.1 Architectural requirements within Armv9-A architecture

$\triangle$ An Armv9 compliant implementation must also be Armv8.5 compliant.

$\triangle$ An Armv9.1 compliant implementation must also be Armv8.6 and Armv9.0 compliant.

$\triangle$ An Armv9.2 compliant implementation must also be Armv8.7 and Armv9.1 compliant.

$\triangle$ An Armv9.3 compliant implementation must also be Armv8.8 and Armv9.2 compliant.
