# 第7章 大规模模拟及通信集成电路

## 7.1 基本模拟集成电路

$\triangle$ 模拟集成电路的设计更倾向于人工定制，更需要经验的积累。与数字集成电路的设计存在显著不同：首先，模拟集成电路并不过分追求高端工艺制程，而是采用相对成熟的工艺制造；其次，模拟集成电路产品的研发周期和使用周期更长，产品更新迭代更缓慢；最后模拟集成电路产品竞争格局更为集中。

$\triangle$ 集成电路在设计方法上存在较大的区别。在设计之初，综合考虑各项指标的折中系统，前后级的集成，工艺偏差等因素。在设计完成之后，还需要进行大量的仿真验证。

### 7.1.1 MOSFET器件放大原理

$\triangle$ MOSFET实现放大功能的基本原理是其固有的”电压控制电流“特性，已通过改变栅源电压$V_{GS}$的幅度来调度沟道电流$I_D$的大小。

**图7.1 典型的NMOS电路及其$I-V$特性曲线**

$\triangle$ NMOS的工作区域大致范围截止区、线性区和饱和区3中。

- 当$V_{GS}<V_{th}$时，NMOS工作在截止区，$I_D$近似为零，源极、漏极之间视为开路。
- 当$V_{GS}\geq V_{th}$时，NMOS的沟道电流$I_D$开始增加，源极、漏极之间的沟道开始导通，此时NMOS表现为线性电阻。
- 在饱和区，$I_D$几乎不随$V_{DS}$变化或随$V_{DS}$略有增大。

$\triangle$ MOSFET优势：

- MOSFET的栅极与导电沟道是绝缘的。
- MOSFET的导电过程主要由多数载流子参与，适用于环境变化比较剧烈的情况。
- MOSFET的噪声系数较少。
- MOSFET的制造工艺便于集成化，可降低成本。

### 7.1.2 运算放大器

$\triangle$ 运算放大器（Operational Amplifier, OPAMP，简称运放）最典型的特征是具有极高的增益。

**图7.2 运算放大器及模拟集成电路的八边形法则**

$\triangle$​ 运算评价指标：

- 开环增益（Open-Loop Gain）：无反馈的增益。
- 增益带宽积（Gain Bandwidth, GBW）：运放对交流小信号的放大倍数降为1时的频率。
- 输入阻抗（Input Impedance）：输入端测得的等效阻抗。
- 输出阻抗（Output Impedance）：输出端测得的等效阻抗。
- 输入失调电压（Input Offset Voltage）：开环使用运放时，使直流输出电平为0而加载在两个输入端之间的直流电压。
- 共模抑制比（Common Mode Rejection Ratio, CMRR）：运放对差模信号和共模信号的放大倍数之比。
- 电源电压抑制比（Power supply Rejection Ratio, PSRR）：对电源噪声的抑制能力。
- 等效输入噪声（Input Reference Noise）：运放输出的噪声在输入端的等效值。
- 转换速率（Slew Rate，SR）：运放对突变信号的响应速度。
- 总谐波失真（Total Harmonic Distortion, THD）：信号通过运放产生的谐波总功率与基波功率之比。
- 增益裕度（Gain Margin, GM）：相频曲线下降180度时对应的增益。
- 相位裕度（Phase Margin, PM）：幅频曲线下降到0dB时的相位裕量。

**图7.3 基本运放电路的结构**

$\triangle$ 运放分类：

- 通用型运放：用于普通场景需求。
- 高输入阻抗型运放：差模输入阻抗极高，有利于接收小信号。
- 低温漂运放：用于仪表等高精密设备中。
- 高速运放：用于模数转换中，大带宽，高转换速率
- 低功耗运放
- 增益可调运放
- 低噪声运放（Low Noise Amplifier，LNA）：用于语音放大电路与射频接收电路。
- 功率放大器（Power Amplifier, PA）：用于射频发射端。

**图7.4 某些芯片系统中的放大器**

### 7.1.3 其他常见模拟集成电路

#### 1. 滤波电路

$\triangle$ 滤波电路分为无源滤波和有源滤波两类。其中无源滤波是通过电阻器、电容器、电感器以及相应的组合，实现低通、高通、带通、带阻的滤波。有源滤波则是通过加入运放，在一定增益的情况下进行滤波。

**图7.5 常见的滤波器**

#### 2. 基准电路

$\triangle$ 基准电路用于为模拟集成电路的其他模块提供基准的电压。

- 常见的基准电路是带隙（Bandgap）基准电路。

**图7.6 带隙基准电路和低压差线性稳压电源电路**

#### 3. 低压差线性稳压电路

$\triangle$ 低压差线性稳压电路（Low Dropout Regulator, LDO）将其转换为所需要的电源电压。

#### 4. 震荡电路

$\triangle$ 需要由内部的震荡电路产生时钟信号，供给数字模块使用。

- 通常用压控振荡器，常见的震荡方式有RC震荡和LC震荡。

#### 5. 混频器

$\triangle$ 混频器的作用是对两个输入信号频率进行运算或组合，对接收信号进行频域处理。

**图7.7 石英震荡电路和混频器的结构。**

### 7.1.4 模拟集成电路的设计流程

$\triangle$ 模拟集成电路的设计流程包括电路设计、前端仿真验证、版图设计、后端仿真验证四个主要环节。

**图7.8 模拟集成电路从需求制定到最终流片的基本流程**

$\triangle$ 模拟集成电路从电路到版图的设计流程仍然以手工实现为主。

### 7.1.5 模拟集成电路未来的发展与挑战



## 7.2 模数转换器及数模转换器

$\triangle$ 模拟与数字之间的桥梁——模数转换器（Analog-to-Digital Convertor, ADC）与数模转换器（Digital-to-Analog Convertor, DAC）。

**图7.9 模拟世界与数字世界的桥梁**

### 7.2.1 模数转换器

**图7.10 一款角度传感器芯片的结构框图**

$\triangle$ ADC由抗混叠滤波器、采样、量化和数据编码4个模块级联而成。

**图7.11 ADC结构示意图**

$\triangle$ ADC会采取过采样的方式来有效降低噪声。

**图7.12 理想采样过程中的模拟信号输入与采样结果**

$\triangle$ 采样模块将时间和幅值连续的模拟信号转换为时间离散的采样信号。时间离散的采样信号需要经幅值量化模块由连续电平转化为离散电平。

**图7.13 3位ADC的量化过程示意图**

$\triangle$ ADC性能参数：

- 静态参数：积分非线性误差（Integral Nonlinearity, INL）、微分非线性误差(Differential Nonlinearity, DNL)、失调误差、增益误差。
- 动态参数：信噪比（Signal to Noise Ratio, SNR）、信噪失真比（Signal to Noise plus Distortion Ratio, SNDR）、有效位数（Effective Number of Bits, ENOB）、动态范围（Dynamic Range, DR）。

#### 1. 信噪比

#### 2. 信噪失真比

#### 3. 有效位数

#### 4. 动态范围

$\triangle$ 动态范围：ADC能够不失真测量的信号幅值上下限比率。

### 7.2.2 数模转换器

$\triangle$ DAC将多为二进制数字信号转换为与之成比例的模拟信号。
$$
V_{out}=KV_{REF}\left(\frac{D_0}{2^1}+\frac{D_1}{2^2}+\frac{D_2}{2^3}+\cdots+\frac{D_{N-1}}{2^N}\right)
$$
其中$K$为比例因子。

#### 1. 电压按比例缩放DAC

$\triangle$ 利用电阻分压。容易实现；当DAC位数较大时，面积较大。

**图7.14 3位电压按比例缩放DAC**

#### 2. 电荷按比例缩放DAC

$\triangle$ 利用电容存储电荷。当DAC精度较高时，电容器的尺寸呈指数级增大。

**图7.15 4位电荷按比例缩放DAC**

#### 3. 电流按比例缩放DAC 

$\triangle$ 利用电组分电流。

**图7.16 4位二进制加权电阻DAC**

### 7.2.3 常用模数转换器的分类

**图7.17 不同种类ADC的性能对比**

#### 1. 闪速型ADC

$\triangle$ 闪速型ADC（Flash ADC）速度最快。利用反压电阻网络对基准电压进行点评划分，然后由比较器阵列进行量化，最后编码。尤其适合高速应用领域。

**图7.18 3位闪存型ADC的结构**

**表7.1 温度计码与二进制码的对应关系**

$\triangle$ 闪速型ADC易于实现，但是面积开销大，只用于8位分辨率以下的场景。动态特性容易受到时钟抖动和信号失真的影响。

#### 2. 两步闪速型ADC

$\triangle$​​ 两步闪速型ADC（Two-Step Flash ADC）比普通闪速型ADC更实用。通过两步转换，每一步转换$N/2$分辨率。

**图7.19 6位两步闪速型ADC**

$\triangle$ 两步闪速型ADC减少了芯片面积，降低了功耗，但是增加了额外的延时。

#### 3. 流水线型ADC

$\triangle$​ 流水线型ADC（Pipeline ADC），兼具高速、高分辨率、低功耗等优点，广泛应用于食品信号处理、无线通信领域和高速数据采集系统。

$\triangle$ 每一级包括一个采样保持电路、低分辨率ADC、一个高分辨率DAC、一个求和运算电路和一个可提供增益的级间放大器。

**图7.20 12位4级流水线型ADC**

#### 4. 折叠内插型ADC

$\triangle$ 折叠技术用于将输入电压分区并减少赋值，从而使比较器需要处理电压范围缩小。内插技术用来产生两个电压中间的电压。

**图7.21 折叠技术**

**图7.22 内插技术**

$\triangle$ 折叠内插型ADC大致包括粗量化和细量化两个模块。粗量化定位这些信号区间。

**图7.23 使用内插技术的3位闪速型ADC结构**

**图7.24 折叠内插型ADC的结构**

#### 5. 逐次逼近型ADC

$\triangle$ 逐次逼近型（Successive Approximation Register, SAR）ADC由采样保持模块、比较器、DAC、逐次逼近逻辑寄存器、控制模块构成。

**图7.25 逐次逼近型ADC的基本结构**

$\triangle$ 逐次逼近型ADC采用二分法进行搜索。

$\triangle$​ 性能在很大程度上取决于DAC和比较器。适用于低功耗场景，但是转换速率较慢。

#### 6. $\Sigma$-$\Delta$型ADC

$\triangle$ 适用于对精度要求极高的场景，高度数字化的架构极其适用于现代先进的CMOS工艺，便于扩展和集成数字功能。

**图7.27 $\Sigma$-$\Delta$型ADC的结构**

#### 7. 时域交织型ADC

$\triangle$ 采用时间交错结构，通过多个并行工作的ADC来同时量化模拟信号，从而提高数据转换器的转换率。

**图7.28 时域交织型ADC的系统结构**

### 7.2.4 模数转换器的发展趋势



## 7.3 通信集成电路

### 7.3.1 4G通信集成电路

#### 1. 4G LTE芯片

**图7.29 4G LTE芯片的架构**

#### 2. RF前端中的模拟集成电路

**图7.30 RF前端芯片模块架构**

### 7.3.2 5G通信集成电路

#### 1. 5G芯片

**图7.32 华为麒麟990 5G芯片**

#### 2. 5G RF前端模拟芯片

**图7.33 5G RF前端芯片模块架构的基本框图**

**图7.34 Broadcom AFEM-8072 5G射频模拟芯片模块的布局**

### 7.3.3 WiFi通信集成电路

#### 1. WiFi芯片

#### 2. WiFi射频前端

**图7.35 WiFi芯片的架构**

#### 3. WiFi6芯片



## 本章小结